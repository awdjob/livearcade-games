{"version":3,"file":"main.min.js","names":["currentstate","loopGameloop","loopPipeloop","debugmode","states","Object","freeze","SplashScreen","GameScreen","ScoreScreen","gravity","velocity","position","rotation","jump","flyArea","$","height","score","highscore","pipeheight","pipewidth","pipes","Array","replayclickable","volume","soundJump","buzz","sound","soundScore","soundHit","soundDie","soundSwoosh","getCookie","cname","name","ca","document","cookie","split","i","length","c","trim","indexOf","substring","setCookie","cvalue","exdays","d","Date","setTime","getTime","expires","toGMTString","showSplash","css","y","x","updatePlayer","stop","play","remove","transition","opacity","startGame","window","parent","postMessage","gameMessage","gameStart","setBigScore","show","setInterval","gameloop","updatePipes","playerJump","player","Math","min","rotate","top","box","getElementById","getBoundingClientRect","boxwidth","sin","abs","boxheight","boxleft","width","left","boxtop","boxright","boxbottom","boundingbox","bottom","offset","playerDead","ceiling","nextpipeupper","children","pipetop","pipeleft","piperight","pipebottom","splice","playerScore","screenClick","erase","elemscore","empty","digits","toString","append","setSmallScore","setHighScore","setMedal","elemmedal","medal","playerbottom","floor","movey","max","clearInterval","isIncompatible","any","showScore","bindOnce","wonmedal","scale","filter","this","constraint","topheight","random","newpipe","push","all","setVolume","addEventListener","ev","data","unmute","mute","ready","gameReady","location","search","savedscore","parseInt","keydown","e","keyCode","click","on","Android","navigator","userAgent","match","BlackBerry","iOS","Opera","Safari","Windows"],"sources":["floppy-bird/js/main.js"],"mappings":"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","ignoreList":[],"sourcesContent":["var debugmode = false;\n\nvar states = Object.freeze({\n   SplashScreen: 0,\n   GameScreen: 1,\n   ScoreScreen: 2\n});\n\nvar currentstate;\n\nvar gravity = 0.25;\nvar velocity = 0;\nvar position = 180;\nvar rotation = 0;\nvar jump = -4.6;\nvar flyArea = $(\"#flyarea\").height();\n\nvar score = 0;\nvar highscore = 0;\n\nvar pipeheight = 90;\nvar pipewidth = 52;\nvar pipes = new Array();\n\nvar replayclickable = false;\n\n//sounds\nvar volume = 30;\nvar soundJump = new buzz.sound(\"assets/sounds/sfx_wing.ogg\");\nvar soundScore = new buzz.sound(\"assets/sounds/sfx_point.ogg\");\nvar soundHit = new buzz.sound(\"assets/sounds/sfx_hit.ogg\");\nvar soundDie = new buzz.sound(\"assets/sounds/sfx_die.ogg\");\nvar soundSwoosh = new buzz.sound(\"assets/sounds/sfx_swooshing.ogg\");\nbuzz.all().setVolume(volume);\n\n//loops\nvar loopGameloop;\nvar loopPipeloop;\n\nwindow.addEventListener(\"message\", (ev) => {\n   if (ev.data.gameMessage) {\n      if (ev.data.sound === true) {\n         window.buzz.all().unmute()\n      } else if (ev.data.sound === false) {\n         window.buzz.all().mute()\n      }\n   }\n})\n$(document).ready(function() {\n   window.parent.postMessage({ gameMessage: true, gameReady: true }, \"*\")\n   if(window.location.search == \"?debug\")\n      debugmode = true;\n   if(window.location.search == \"?easy\")\n      pipeheight = 200;\n\n   //get the highscore\n   var savedscore = getCookie(\"highscore\");\n   if(savedscore != \"\")\n      highscore = parseInt(savedscore);\n\n   //start with the splash screen\n   showSplash();\n});\n\nfunction getCookie(cname)\n{\n   var name = cname + \"=\";\n   var ca = document.cookie.split(';');\n   for(var i=0; i<ca.length; i++)\n   {\n      var c = ca[i].trim();\n      if (c.indexOf(name)==0) return c.substring(name.length,c.length);\n   }\n   return \"\";\n}\n\nfunction setCookie(cname,cvalue,exdays)\n{\n   var d = new Date();\n   d.setTime(d.getTime()+(exdays*24*60*60*1000));\n   var expires = \"expires=\"+d.toGMTString();\n   document.cookie = cname + \"=\" + cvalue + \"; \" + expires;\n}\n\nfunction showSplash()\n{\n   currentstate = states.SplashScreen;\n\n   //set the defaults (again)\n   velocity = 0;\n   position = 180;\n   rotation = 0;\n   score = 0;\n\n   //update the player in preparation for the next game\n   $(\"#player\").css({ y: 0, x: 0 });\n   updatePlayer($(\"#player\"));\n\n   soundSwoosh.stop();\n   soundSwoosh.play();\n\n   //clear out all the pipes if there are any\n   $(\".pipe\").remove();\n   pipes = new Array();\n\n   //make everything animated again\n   $(\".animated\").css('animation-play-state', 'running');\n   $(\".animated\").css('-webkit-animation-play-state', 'running');\n\n   //fade in the splash\n   $(\"#splash\").transition({ opacity: 1 }, 2000, 'ease');\n}\n\nfunction startGame()\n{\n   window.parent.postMessage({ gameMessage: true, gameStart: true }, \"*\")\n   currentstate = states.GameScreen;\n\n   //fade out the splash\n   $(\"#splash\").stop();\n   $(\"#splash\").transition({ opacity: 0 }, 500, 'ease');\n\n   //update the big score\n   setBigScore();\n\n   //debug mode?\n   if(debugmode)\n   {\n      //show the bounding boxes\n      $(\".boundingbox\").show();\n   }\n\n   //start up our loops\n   var updaterate = 1000.0 / 60.0 ; //60 times a second\n   loopGameloop = setInterval(gameloop, updaterate);\n   loopPipeloop = setInterval(updatePipes, 1400);\n\n   //jump from the start!\n   playerJump();\n}\n\nfunction updatePlayer(player)\n{\n   //rotation\n   rotation = Math.min((velocity / 10) * 90, 90);\n\n   //apply rotation and position\n   $(player).css({ rotate: rotation, top: position });\n}\n\nfunction gameloop() {\n   var player = $(\"#player\");\n\n   //update the player speed/position\n   velocity += gravity;\n   position += velocity;\n\n   //update the player\n   updatePlayer(player);\n\n   //create the bounding box\n   var box = document.getElementById('player').getBoundingClientRect();\n   var origwidth = 34.0;\n   var origheight = 24.0;\n\n   var boxwidth = origwidth - (Math.sin(Math.abs(rotation) / 90) * 8);\n   var boxheight = (origheight + box.height) / 2;\n   var boxleft = ((box.width - boxwidth) / 2) + box.left;\n   var boxtop = ((box.height - boxheight) / 2) + box.top;\n   var boxright = boxleft + boxwidth;\n   var boxbottom = boxtop + boxheight;\n\n   //if we're in debug mode, draw the bounding box\n   if(debugmode)\n   {\n      var boundingbox = $(\"#playerbox\");\n      boundingbox.css('left', boxleft);\n      boundingbox.css('top', boxtop);\n      boundingbox.css('height', boxheight);\n      boundingbox.css('width', boxwidth);\n   }\n\n   //did we hit the ground?\n   if(box.bottom >= $(\"#land\").offset().top)\n   {\n      playerDead();\n      return;\n   }\n\n   //have they tried to escape through the ceiling? :o\n   var ceiling = $(\"#ceiling\");\n   if(boxtop <= (ceiling.offset().top + ceiling.height()))\n      position = 0;\n\n   //we can't go any further without a pipe\n   if(pipes[0] == null)\n      return;\n\n   //determine the bounding box of the next pipes inner area\n   var nextpipe = pipes[0];\n   var nextpipeupper = nextpipe.children(\".pipe_upper\");\n\n   var pipetop = nextpipeupper.offset().top + nextpipeupper.height();\n   var pipeleft = nextpipeupper.offset().left - 2; // for some reason it starts at the inner pipes offset, not the outer pipes.\n   var piperight = pipeleft + pipewidth;\n   var pipebottom = pipetop + pipeheight;\n\n   if(debugmode)\n   {\n      var boundingbox = $(\"#pipebox\");\n      boundingbox.css('left', pipeleft);\n      boundingbox.css('top', pipetop);\n      boundingbox.css('height', pipeheight);\n      boundingbox.css('width', pipewidth);\n   }\n\n   //have we gotten inside the pipe yet?\n   if(boxright > pipeleft)\n   {\n      //we're within the pipe, have we passed between upper and lower pipes?\n      if(boxtop > pipetop && boxbottom < pipebottom)\n      {\n         //yeah! we're within bounds\n\n      }\n      else\n      {\n         //no! we touched the pipe\n         playerDead();\n         return;\n      }\n   }\n\n\n   //have we passed the imminent danger?\n   if(boxleft > piperight)\n   {\n      //yes, remove it\n      pipes.splice(0, 1);\n\n      //and score a point\n      playerScore();\n   }\n}\n\n//Handle space bar\n$(document).keydown(function(e){\n   //space bar!\n   if(e.keyCode == 32)\n   {\n      //in ScoreScreen, hitting space should click the \"replay\" button. else it's just a regular spacebar hit\n      if(currentstate == states.ScoreScreen)\n         $(\"#replay\").click();\n      else\n         screenClick();\n   }\n});\n\n//Handle mouse down OR touch start\nif(\"ontouchstart\" in window)\n   $(document).on(\"touchstart\", screenClick);\nelse\n   $(document).on(\"mousedown\", screenClick);\n\nfunction screenClick()\n{\n   if(currentstate == states.GameScreen)\n   {\n      playerJump();\n   }\n   else if(currentstate == states.SplashScreen)\n   {\n      startGame();\n   }\n}\n\nfunction playerJump()\n{\n   velocity = jump;\n   //play jump sound\n   soundJump.stop();\n   soundJump.play();\n}\n\nfunction setBigScore(erase)\n{\n   var elemscore = $(\"#bigscore\");\n   elemscore.empty();\n\n   if(erase)\n      return;\n\n   var digits = score.toString().split('');\n   for(var i = 0; i < digits.length; i++)\n      elemscore.append(\"<img src='assets/font_big_\" + digits[i] + \".png' alt='\" + digits[i] + \"'>\");\n}\n\nfunction setSmallScore()\n{\n   var elemscore = $(\"#currentscore\");\n   elemscore.empty();\n\n   var digits = score.toString().split('');\n   for(var i = 0; i < digits.length; i++)\n      elemscore.append(\"<img src='assets/font_small_\" + digits[i] + \".png' alt='\" + digits[i] + \"'>\");\n}\n\nfunction setHighScore()\n{\n   var elemscore = $(\"#highscore\");\n   elemscore.empty();\n\n   var digits = highscore.toString().split('');\n   for(var i = 0; i < digits.length; i++)\n      elemscore.append(\"<img src='assets/font_small_\" + digits[i] + \".png' alt='\" + digits[i] + \"'>\");\n}\n\nfunction setMedal()\n{\n   var elemmedal = $(\"#medal\");\n   elemmedal.empty();\n\n   if(score < 10)\n      //signal that no medal has been won\n      return false;\n\n   if(score >= 10)\n      medal = \"bronze\";\n   if(score >= 20)\n      medal = \"silver\";\n   if(score >= 30)\n      medal = \"gold\";\n   if(score >= 40)\n      medal = \"platinum\";\n\n   elemmedal.append('<img src=\"assets/medal_' + medal +'.png\" alt=\"' + medal +'\">');\n\n   //signal that a medal has been won\n   return true;\n}\n\nfunction playerDead()\n{\n   //stop animating everything!\n   $(\".animated\").css('animation-play-state', 'paused');\n   $(\".animated\").css('-webkit-animation-play-state', 'paused');\n\n   //drop the bird to the floor\n   var playerbottom = $(\"#player\").position().top + $(\"#player\").width(); //we use width because he'll be rotated 90 deg\n   var floor = flyArea;\n   var movey = Math.max(0, floor - playerbottom);\n   $(\"#player\").transition({ y: movey + 'px', rotate: 90}, 1000, 'easeInOutCubic');\n\n   //it's time to change states. as of now we're considered ScoreScreen to disable left click/flying\n   currentstate = states.ScoreScreen;\n\n   //destroy our gameloops\n   clearInterval(loopGameloop);\n   clearInterval(loopPipeloop);\n   loopGameloop = null;\n   loopPipeloop = null;\n\n   //mobile browsers don't support buzz bindOnce event\n   if(isIncompatible.any())\n   {\n      //skip right to showing score\n      showScore();\n   }\n   else\n   {\n      //play the hit sound (then the dead sound) and then show score\n      soundHit.play().bindOnce(\"ended\", function() {\n         soundDie.play().bindOnce(\"ended\", function() {\n            showScore();\n         });\n      });\n   }\n}\n\nfunction showScore()\n{\n   //unhide us\n   $(\"#scoreboard\").css(\"display\", \"block\");\n\n   //remove the big score\n   setBigScore(true);\n\n   //have they beaten their high score?\n   if(score > highscore)\n   {\n      //yeah!\n      highscore = score;\n      //save it!\n      setCookie(\"highscore\", highscore, 999);\n   }\n\n   //update the scoreboard\n   setSmallScore();\n   setHighScore();\n   var wonmedal = setMedal();\n\n   //SWOOSH!\n   soundSwoosh.stop();\n   soundSwoosh.play();\n\n   //show the scoreboard\n   $(\"#scoreboard\").css({ y: '40px', opacity: 0 }); //move it down so we can slide it up\n   $(\"#replay\").css({ y: '40px', opacity: 0 });\n   $(\"#scoreboard\").transition({ y: '0px', opacity: 1}, 600, 'ease', function() {\n      //When the animation is done, animate in the replay button and SWOOSH!\n      soundSwoosh.stop();\n      soundSwoosh.play();\n      $(\"#replay\").transition({ y: '0px', opacity: 1}, 600, 'ease');\n\n      //also animate in the MEDAL! WOO!\n      if(wonmedal)\n      {\n         $(\"#medal\").css({ scale: 2, opacity: 0 });\n         $(\"#medal\").transition({ opacity: 1, scale: 1 }, 1200, 'ease');\n      }\n   });\n\n   //make the replay button clickable\n   replayclickable = true;\n\n   window.parent.postMessage({ gameMessage: true, score }, \"*\")\n}\n\n$(\"#replay\").click(function() {\n   //make sure we can only click once\n   if(!replayclickable)\n      return;\n   else\n      replayclickable = false;\n   //SWOOSH!\n   soundSwoosh.stop();\n   soundSwoosh.play();\n\n   //fade out the scoreboard\n   $(\"#scoreboard\").transition({ y: '-40px', opacity: 0}, 1000, 'ease', function() {\n      //when that's done, display us back to nothing\n      $(\"#scoreboard\").css(\"display\", \"none\");\n\n      //start the game over!\n      showSplash();\n   });\n});\n\nfunction playerScore()\n{\n   score += 1;\n   //play score sound\n   soundScore.stop();\n   soundScore.play();\n   setBigScore();\n}\n\nfunction updatePipes()\n{\n   //Do any pipes need removal?\n   $(\".pipe\").filter(function() { return $(this).position().left <= -100; }).remove()\n\n   //add a new pipe (top height + bottom height  + pipeheight == flyArea) and put it in our tracker\n   var padding = 80;\n   var constraint = flyArea - pipeheight - (padding * 2); //double padding (for top and bottom)\n   var topheight = Math.floor((Math.random()*constraint) + padding); //add lower padding\n   var bottomheight = (flyArea - pipeheight) - topheight;\n   var newpipe = $('<div class=\"pipe animated\"><div class=\"pipe_upper\" style=\"height: ' + topheight + 'px;\"></div><div class=\"pipe_lower\" style=\"height: ' + bottomheight + 'px;\"></div></div>');\n   $(\"#flyarea\").append(newpipe);\n   pipes.push(newpipe);\n}\n\nvar isIncompatible = {\n   Android: function() {\n   return navigator.userAgent.match(/Android/i);\n   },\n   BlackBerry: function() {\n   return navigator.userAgent.match(/BlackBerry/i);\n   },\n   iOS: function() {\n   return navigator.userAgent.match(/iPhone|iPad|iPod/i);\n   },\n   Opera: function() {\n   return navigator.userAgent.match(/Opera Mini/i);\n   },\n   Safari: function() {\n   return (navigator.userAgent.match(/OS X.*Safari/) && ! navigator.userAgent.match(/Chrome/));\n   },\n   Windows: function() {\n   return navigator.userAgent.match(/IEMobile/i);\n   },\n   any: function() {\n   return (isIncompatible.Android() || isIncompatible.BlackBerry() || isIncompatible.iOS() || isIncompatible.Opera() || isIncompatible.Safari() || isIncompatible.Windows());\n   }\n};"]}